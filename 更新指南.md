# 如何更新 Offline Calendar 程序

本文档将指导您在修改了 `main.py` 源码后，如何重新打包并更新已安装的 `Offline Calendar` 程序。

---

### 前提

确保您的项目目录结构和 Python 虚拟环境 (`.venv`) 仍然存在。

### 更新流程

总共需要三个步骤。请在您的项目根目录 (`/home/ck/开发/OfflineCalendar/`) 中打开终端，然后按顺序执行以下命令。

#### 步骤 1: 重新打包程序

此步骤会使用 `PyInstaller` 读取您修改后的 `main.py` 文件，并生成一个全新的单文件可执行程序。旧的程序包会被自动覆盖。

```bash
/home/ck/开发/OfflineCalendar/.venv/bin/python -m PyInstaller main.py --name OfflineCalendar --onefile --windowed --icon=icon.png
```

执行完毕后，您会在 `dist` 文件夹内看到新生成的 `OfflineCalendar` 文件。

#### 步骤 2: 替换已安装的程序

此步骤会将新生成的程序文件复制到您系统的本地程序目录中，替换掉旧版本。

```bash
cp /home/ck/开发/OfflineCalendar/dist/OfflineCalendar /home/ck/.local/bin/
```

#### 步骤 3: 确保执行权限（关键步骤）

此步骤是确保系统能够将这个文件作为程序来运行。这也是我们之前发现的关键点。

```bash
chmod +x /home/ck/.local/bin/OfflineCalendar
```

---

### 完成

完成以上三个步骤后，您从应用程序菜单启动“Offline Calendar”时，运行的就将是您修改过的新版本了。图标和快捷方式都无需再次更改。
